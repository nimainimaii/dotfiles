#!/bin/sh

ALLFONTS=$(grep "^! " "${XDG_CONFIG_HOME}/X11/fontprofiles" | sed 's/^..//g')

if [ -n "$*" ]
then
	SELFONT="${*}"
else
	SELFONT="$(echo "$ALLFONTS" | dmenu -i)"
fi

if echo "$ALLFONTS" | grep -q "^${SELFONT}$"
then
	grep "^! ${SELFONT}$" -A3 "${XDG_CONFIG_HOME}/X11/fontprofiles" | xrdb -merge
 
	# shellcheck disable=SC2046
 	kill -s USR1 $(pidof st)
 
	# shellcheck disable=SC2046
	kill -HUP $(pidof dwm)
 
 	restart-dunst
 
 	[ -z "$*" ] && notify-send "Font set to ${SELFONT}"
else
	exit 1
fi
